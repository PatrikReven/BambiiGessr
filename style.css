:root{
    --bg:#0f1020;
    --panel:#171833;
    --muted:#8e95b3;
    --text:#e7e9f7;
    --accent:#7c5cff;
    --danger:#ff5c7c;
    --good:#5cff8d;
    --border:rgba(255,255,255,0.08);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:linear-gradient(135deg,#090a16 0%, #14163a 60%, #0f1230 100%);
    color:var(--text);
    font-family: ui-sans-serif, system-ui, "Segoe UI", Roboto, Helvetica, Arial;
    display:flex;flex-direction:column;
    cursor: crosshair;
  }
  
  .topbar{
    padding:10px 14px;
    display:flex;align-items:center;gap:12px;
    border-bottom:1px solid var(--border);
    background:rgba(0,0,0,0.18);
    backdrop-filter: blur(8px);
  }
  .logo-img{
    width:38px;height:38px;object-fit:contain;border-radius:10px;
    background:#0c0d20;padding:4px;border:1px solid var(--border)
  }
  .title h1{margin:0;font-size:18px}
  .title .sub{margin:2px 0 0;color:var(--muted);font-size:12px}
  .spacer{flex:1}
  
  .target-inline{display:flex;align-items:center;gap:8px;font-size:13px}
  .target-inline .label{color:var(--muted)}
  .btn.small{padding:6px 10px;font-size:12px;border-radius:10px}
  
  .wrap{
    flex:1;
    display:grid;
    grid-template-columns: 360px 1fr;
    gap:14px;
    padding:14px;
  }
  @media (max-width: 980px){
    .wrap{grid-template-columns:1fr}
    #map{min-height:60dvh}
  }
  
  #panel{
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:16px;
    padding:14px;
    display:flex;
    flex-direction:column;
    gap:12px
  }
  
  .card{
    border:1px solid var(--border);
    border-radius:14px;
    padding:12px;
    background:rgba(0,0,0,0.15);
    box-shadow:0 8px 30px rgba(0,0,0,.25);
  }
  .card h2{
    margin:0 0 10px 0;
    font-size:14px;
    letter-spacing:.3px;
    color:#cfd2ff;
  }
  
  .row{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
  .lbl{font-size:12px;color:var(--muted)}
  .select, .input, .btn{
    border-radius:12px;border:1px solid var(--border);
    background:#0f112a;color:var(--text);
    padding:10px 12px;font-size:14px
  }
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{cursor:pointer;transition:.15s transform ease, .15s box-shadow ease}
  .btn:hover{transform:translateY(-1px)}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .btn.primary{background:linear-gradient(90deg,#6a56ff,#7c5cff)}
  .btn.warn{background:#2d1030;border-color:#53123b}
  .btn.success{background:#10322b;border-color:#1f6f5b}
  .btn.ghost{background:transparent;border-color:var(--border)}
  
  .segmented{display:flex;gap:8px}
  .seg{
    flex:1;
    border-radius:10px;border:1px solid var(--border);padding:8px 10px;
    background:#0f112a;color:var(--text);cursor:pointer;font-size:13px
  }
  .seg.active{outline:2px solid #6a56ff}
  
  .now-playing .statline{
    display:flex;gap:10px;justify-content:space-between;margin-bottom:10px;flex-wrap:wrap
  }
  .stat{flex:1;border:1px solid var(--border);border-radius:10px;padding:8px 10px;background:rgba(0,0,0,0.1);min-width:130px}
  .stat .k{font-size:11px;color:var(--muted)}
  .stat .v{font-size:16px;margin-top:2px}
  
  .prompt{
    margin-top:6px;padding:10px;border-radius:10px;border:1px dashed var(--border);
    background:rgba(0,0,0,0.12)
  }
  .prompt .label{font-size:11px;color:var(--muted)}
  #targetName{font-size:16px;margin-top:4px}
  
  .feedback{margin-top:10px;font-size:13px;min-height:20px}
  .feedback.ok{color:var(--good)}
  .feedback.bad{color:var(--danger)}
  
  .board{display:flex;flex-direction:column;gap:6px}
  .board .rowline{
    display:flex;justify-content:space-between;gap:8px;align-items:center;
    border:1px solid var(--border);border-radius:10px;padding:6px 8px;font-size:13px
  }
  .board .tag{font-size:11px;color:var(--muted)}
  
  #map{
    width:100%;
    height:calc(100dvh - 140px);
    border-radius:16px;border:1px solid var(--border);overflow:hidden;
    position:relative;
    box-shadow:0 15px 50px rgba(0,0,0,.35);
  }
  .map-vignette{
    position:absolute;inset:0;pointer-events:none;
    box-shadow: inset 0 0 220px rgba(0,0,0,.55);
  }
  
  .foot{
    border-top:1px solid var(--border);
    padding:10px 14px;color:var(--muted);font-size:12px;
    background:rgba(0,0,0,0.15)
  }
  
  /* Overlay */
  .overlay{
    position:fixed;inset:0;background:rgba(4,6,20,.7);backdrop-filter:blur(8px);
    display:none;align-items:center;justify-content:center;z-index:9999
  }
  .overlay.show{display:flex}
  .overlay-card{
    width:min(520px,92vw);background:#161838;border:1px solid var(--border);
    border-radius:16px;padding:18px
  }
  .overlay-card h2{margin:0 0 12px 0}
  
  /* Leaflet tweak: temna, brez label */
  .leaflet-container{background:#070a14}
  .leaflet-marker-icon, .leaflet-marker-shadow{filter: drop-shadow(0 2px 6px rgba(0,0,0,.45));}
  